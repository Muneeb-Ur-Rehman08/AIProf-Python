{% extends "base.html" %}
{% load static %}
{% block content %}
<!-- Search Input -->
<div class="min-h-screen bg-gradient-to-b from-purple-50 to-white text-black" hx-replace-url="{% url 'list_assistants' %}">
 
    {% include 'modal/navbar.html' %}
  
   
  

  <div class="sticky top-14 z-30 bg-white p-4 border-b">
    <div class=" flex items-center gap-4">

      <div class="flex-1">
        <label id="search-input" class="input input-bordered flex items-center gap-2 bg-transparent w-full">
          <input type="text" hx-push-url="true" class="grow" autocomplete="off" placeholder="Search"
            hx-get="{% url 'list_assistants' %}" hx-target="#assistants-list" hx-trigger="keyup changed delay:500ms"
            name="keyword" hx-include="[name='subject']:checked,[name='topic']:checked,[name='keyword']" />
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="h-4 w-4">
            <path fill-rule="evenodd"
              d="M9.965 11.026a5 5 0 1 1 1.06-1.06l2.755 2.754a.75.75 0 1 1-1.06 1.06l-2.755-2.754ZM10.5 7a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0Z"
              clip-rule="evenodd" />
          </svg>
        </label>
      </div>

      <!-- Sort dropdown -->
      <div class="w-48">
        <select 
          class="select select-bordered w-full bg-white"
          name="sort"
          hx-get="{% url 'list_assistants' %}"
          hx-push-url="true"
          hx-target="#assistants-list"
          hx-trigger="change"
          hx-include="[name='subject']:checked,[name='topic']:checked,[name='keyword'],[name='filter_rating']:checked,[name='sort'],[name='created_by_me']"
        >
          <option value="" disabled>Select sorting option</option>
          {% for value, label in sorting_options.items %}
            <option value="{{ label}}" {% if label == current_sort %}selected{% endif %}>
              {{ label }}
            </option>
          {% endfor %}
        </select>
      </div>

      <!-- Created by me filter -->
      <div class="flex items-center">
        <label class="cursor-pointer label gap-2">
          <span class="label-text">Created by me</span>
          <input type="checkbox" 
                 class="checkbox checkbox-primary" 
                 name="created_by_me"
                 hx-get="{% url 'list_assistants' %}"
                 hx-push-url="true"
                 hx-target="#assistants-list"
                 hx-trigger="change"
                 hx-include="[name='subject']:checked,[name='topic']:checked,[name='keyword'],[name='filter_rating']:checked,[name='sort'],[name='created_by_me']"
                 {% if created_by_me %}checked{% endif %}
          >
        </label>
      </div>
    </div>

  </div>
  <!-- Filters Section -->
  <div class="">
    <!-- Main content area -->

    <div class="lg:flex">
      {% include 'assistant/form_filters.html' %}
    </div>

    <!-- Assistants list content -->
    <main class="flex-1 lg:ml-72 pt-14" style="z-index: 1;" id="assistants-list" hx-get="{% url 'list_assistants' %}" hx-trigger="load"
      hx-replace-url="false">
      <!-- Content loaded dynamically -->
    </main>
  </div>
</div>

<script>
  function handleScroll() {
    const searchBar = document.getElementById('search-bar');
    const navbar = document.getElementById('navbar');
    const searchInput = document.getElementById('search-input');

    if (window.scrollY > 20) {
      searchBar.style.transition = 'top 0.3s ease';
      searchBar.classList.remove('top-28');
      searchBar.classList.add('top-16');
      searchInput.classList.remove('bg-transparent');
      searchInput.classList.add('bg-purple-600');
      navbar.classList.add('bg-purple-600',"shadow-xl" , "overflow-hidden");
    } else {
      searchBar.style.transition = 'top 0.3s ease';
      searchBar.classList.remove('top-16');
      searchBar.classList.add('top-28');
      searchInput.classList.remove('bg-purple-600');
      searchInput.classList.add('bg-transparent');
      navbar.classList.remove('bg-purple-600', "shadow-xl" , "overflow-hidden");
    }
  }

  window.addEventListener('scroll', handleScroll);
</script>

{% endblock %}